{%extends "anytable.html" %}

{% block find %}

<form action="{{ uri }}" method="post" class="search_form">
    <input name="search_info" type="text" style="flex:10;" placeholder="–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞">

    <input id="search_btn" type="submit" class="ok_btn" value="‚û°Ô∏è">
    <a href="{{ uri }}" title="–û—á–∏—Å—Ç–∏—Ç—å –ø–æ–∏—Å–∫" style="text-decoration: none;">üóëÔ∏è</a>
</form>

{% endblock %}


{% block content %}
    {% if oborud %}
{% for item in oborud%}
<tr>
    <td>{{item.Otdel}}</td>
    <td>{{item.RabocheeMesto}}</td>
    <td>{{item.SistemnijBlok}}</td>
    <td>{{item.Monitor}}</td>
    <td>{{item.Processor}}</td>
    <td>{{item.OperPamyat}}</td>
    <td>{{item.PostPamyat}}</td>
    <td>{{item.GPU}}</td>
    <td>{{item.Printer}}</td>
    <td>{{item.MatPlata}}</td>
    <td>{{item.BlokPitaniya}}</td>
    <td>{{item.UPS}}</td>
</tr>
{%endfor%}
    {% else %}
        <tr><td></td></tr>
    {% endif %}
{% endblock %}

{% block add_form %}
<a id="add_close" href="" class="popup__close">X</a>
<div class="popup__title">–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</div>
    <input id="addOtdel" name="Otdel" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–¥–µ–ª " /><br>
    <input id="addRabocheeMesto" name="RabocheeMesto" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ " /><br>
    <input id="addSistemnijBlok" name="SistemnijBlok" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –±–ª–æ–∫ " /><br>
    <input id="addMonitor" name="Monitor" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä " /><br>
    <input id="addProcessor" name="Processor" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä " /><br>
    <input id="addOperPamyat" name="OperPamyat" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –û–ó–£ " /><br>
    <input id="addPostPamyat" name="PostPamyat" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ü–ó–£ " /><br>
    <input id="addGPU" name="GPU" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ GPU " /><br>
    <input id="addPrinter" name="Printer" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–Ω—Ç–µ—Ä " /><br>
    <input id="addMatPlata" name="MatPlata" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫—É—é –ø–ª–∞—Ç—É " /><br>
    <input id="addBlokPitaniya" name="BlokPitaniya" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –±–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è " /><br>
    <input id="addUPS" name="UPS" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ UPS " /><br>
<input id="add_sub_btn" type="button" value="Ok" />

{% endblock %}

{% block delete_form %}
<a id="del_close" href="" class="popup__close">X</a>
<div name="del_title" class="popup__title">–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è </div>
<div class="popup__text">–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å ?</div>
<input id="del_btn" type="button" class="ok_btn" value="Ok">
{% endblock %}

{% block update_form %}
<a id="up_close" href="" class="popup__close">X</a>
<div name="up_title" class="popup__title">–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</div>

    <label for="upOtdel"></label><input id="upOtdel" name="Otdel" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –æ—Ç–¥–µ–ª " /><br>
    <label for="upRabocheeMesto"></label><input id="upRabocheeMesto" name="RabocheeMesto" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ " /><br>
    <label for="upSistemnijBlok"></label><input id="upSistemnijBlok" name="SistemnijBlok" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∏—Å—Ç–µ–º–Ω—ã–π –±–ª–æ–∫ " /><br>
    <label for="upMonitor"></label><input id="upMonitor" name="Monitor" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä " /><br>
    <label for="upProcessor"></label><input id="upProcessor" name="Processor" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä " /><br>
    <label for="upOperPamyat"></label><input id="upOperPamyat" name="OperPamyat" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –û–ó–£ " /><br>
    <label for="upPostPamyat"></label><input id="upPostPamyat" name="PostPamyat" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ü–ó–£ " /><br>
    <label for="upGPU"></label><input id="upGPU" name="GPU" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ GPU " /><br>
    <label for="upPrinter"></label><input id="upPrinter" name="Printer" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø—Ä–∏–Ω—Ç–µ—Ä " /><br>
    <label for="upMatPlata"></label><input id="upMatPlata" name="MatPlata" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –º–∞—Ç–µ—Ä–∏–Ω—Å–∫—É—é –ø–ª–∞—Ç—É " /><br>
    <label for="upBlokPitaniya"></label><input id="upBlokPitaniya" name="BlokPitaniya" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –±–ª–æ–∫ –ø–∏—Ç–∞–Ω–∏—è " /><br>
    <label for="upUPS"></label><input id="upUPS" name="UPS" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ UPS " /><br>
<input id="up_btn" type="button" value="Ok" />

{% endblock %}


{% block user_script%}

<script>
    let Otdel;
    let RabocheeMesto;
    let SistemnijBlok;
    let Monitor;
    let Processor;
    let OperPamyat;
    let PostPamyat;
    let GPU;
    let Printer;
    let MatPlata;
    let BlokPitaniya;
    let UPS;

    {% if add_option %}
    document.querySelector("#add_sub_btn").onclick = function() {
        let xhr = new XMLHttpRequest();
        xhr.open('POST', "{{ uri }}");
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({
            "Otdel": addOtdel.value,
            "RabocheeMesto": addRabocheeMesto.value,
            "SistemnijBlok": addSistemnijBlok.value,
            "Monitor": addMonitor.value,
            "Processor": addProcessor.value,
            "OperPamyat": addOperPamyat.value + "",
            "PostPamyat": addPostPamyat.value + "",
            "GPU": addGPU.value + "",
            "Printer": addPrinter.value + "",
            "MatPlata": addMatPlata.value + "",
            "BlokPitaniya": addBlokPitaniya.value + "",
            "UPS": addUPS.value + "",
        }));

        xhr.onload = function() {
            let jsonResponse = JSON.parse(xhr.responseText);
            up_close.href = "#msgpopup";
            up_close.click();
            msgtext.innerHTML = jsonResponse["msg"];
            msgtitle.innerHTML = jsonResponse["msg_title"];
            up_close.href = "";
        }

    };

    {% endif %}

    {% if up_option %}
    document.querySelector("#up_btn").onclick = function() {
        let xhr = new XMLHttpRequest();
        xhr.open('PATCH', "{{ uri }}?Otdel="+Otdel+"&RabocheeMesto="+RabocheeMesto);
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
        xhr.send(JSON.stringify({
            "Otdel": upOtdel.value,
            "RabocheeMesto": upRabocheeMesto.value + "",
            "SistemnijBlok": upSistemnijBlok.value + "",
            "Monitor": upMonitor.value + "",
            "Processor": upProcessor.value + "",
            "OperPamyat": upOperPamyat.value + "",
            "PostPamyat": upPostPamyat.value + "",
            "GPU": upGPU.value + "",
            "Printer": upPrinter.value + "",
            "MatPlata": upMatPlata.value + "",
            "BlokPitaniya": upBlokPitaniya.value + "",
            "UPS": upUPS.value + "",
        }));

        xhr.onload = function() {
            let jsonResponse = JSON.parse(xhr.responseText);
            up_close.href = "#msgpopup";
            up_close.click();
            msgtext.innerHTML = jsonResponse["msg"];
            msgtitle.innerHTML = jsonResponse["msg_title"];
            up_close.href = "";
        }

    };

    document.querySelector("#l1").addEventListener("click", () => {
        if (window.tr) {

            Otdel = window.tr.getElementsByTagName("td")[0].innerHTML;
            RabocheeMesto = window.tr.getElementsByTagName("td")[1].innerHTML;
            SistemnijBlok = window.tr.getElementsByTagName("td")[2].innerHTML;
            Monitor = window.tr.getElementsByTagName("td")[3].innerHTML;
            Processor = window.tr.getElementsByTagName("td")[4].innerHTML;
            OperPamyat = window.tr.getElementsByTagName("td")[5].innerHTML;
            PostPamyat = window.tr.getElementsByTagName("td")[6].innerHTML;
            GPU = window.tr.getElementsByTagName("td")[7].innerHTML;
            Printer = window.tr.getElementsByTagName("td")[8].innerHTML;
            MatPlata = window.tr.getElementsByTagName("td")[9].innerHTML;
            BlokPitaniya = window.tr.getElementsByTagName("td")[10].innerHTML;
            UPS = window.tr.getElementsByTagName("td")[11].innerHTML;
        }
        let title = document.getElementsByName("del_title")[0];
        title.innerHTML += " " + Otdel;
        upOtdel.value = Otdel;
        upRabocheeMesto.value = RabocheeMesto;
        upSistemnijBlok.value = SistemnijBlok;
        upMonitor.value = Monitor;
        upProcessor.value = Processor;
        upOperPamyat.value = OperPamyat;
        upPostPamyat.value = PostPamyat;
        upGPU.value = GPU;
        upPrinter.value = Printer;
        upMatPlata.value = MatPlata;
        upBlokPitaniya.value = BlokPitaniya;
        upUPS.value = UPS;

    }, false);

    {% endif %}

    {% if del_option %}
    document.querySelector("#del_btn").onclick = function() {

        let xhr = new XMLHttpRequest();
        xhr.open('DELETE', "{{ uri }}");
        xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");


        xhr.send(JSON.stringify({
            "Otdel": Otdel,
            "RabocheeMesto": RabocheeMesto
        }));

        xhr.onload = function() {

            let jsonResponse = JSON.parse(xhr.responseText);
            del_close.href = "#msgpopup";
            del_close.click();
            msgtext.innerHTML = jsonResponse["msg"];
            msgtitle.innerHTML = jsonResponse["msg_title"];
            del_close.href = "";
        }


    };


    document.querySelector("#l2").addEventListener("click", () => {
        if (window.tr) {
            Otdel = window.tr.getElementsByTagName("td")[0].innerHTML;
            RabocheeMesto = window.tr.getElementsByTagName("td")[1].innerHTML;
            SistemnijBlok = window.tr.getElementsByTagName("td")[2].innerHTML;
            Monitor = window.tr.getElementsByTagName("td")[3].innerHTML;
            Processor = window.tr.getElementsByTagName("td")[4].innerHTML;
            OperPamyat = window.tr.getElementsByTagName("td")[5].innerHTML;
            PostPamyat = window.tr.getElementsByTagName("td")[6].innerHTML;
            GPU = window.tr.getElementsByTagName("td")[7].innerHTML;
            Printer = window.tr.getElementsByTagName("td")[8].innerHTML;
            MatPlata = window.tr.getElementsByTagName("td")[9].innerHTML;
            BlokPitaniya = window.tr.getElementsByTagName("td")[10].innerHTML;
            UPS = window.tr.getElementsByTagName("td")[11].innerHTML;
        }
        let title = document.getElementsByName("del_title")[0];
        title.innerHTML += " " + Otdel;
    }, false);

    {% endif %}

</script>
{% endblock %}
